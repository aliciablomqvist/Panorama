@page "/SortMovies/{movieListId:int}"
@model PanoramaApp.Pages.MovieLists.SortMoviesModel

<h2>Sortera Filmer i Lista @Model.MovieListId</h2>

<select id="sortBy" class="form-select">
    <option value="Title">Titel</option>
    <option value="ReleaseDate">Utgivningsdatum</option>
</select>

<ul id="sortedMovieList">
    @foreach (var movie in Model.Movies)
    {
        <li>@movie.Title - @movie.ReleaseDate.ToShortDateString()</li>
    }
</ul>

@section Scripts {
    <script>
        const movieListId = @Model.MovieListId;

        document.getElementById('sortBy').addEventListener('change', async () => {
            const sortBy = document.getElementById('sortBy').value;
            const response = await fetch(`/SortMovies/${movieListId}?sortBy=${sortBy}`);
            const movies = await response.json();

            const sortedList = document.getElementById('sortedMovieList');
            sortedList.innerHTML = '';
            movies.forEach(movie => {
                const li = document.createElement('li');
                li.textContent = `${movie.title} - ${new Date(movie.releaseDate).toLocaleDateString()}`;
                sortedList.appendChild(li);
            });
        });
    </script>
}
